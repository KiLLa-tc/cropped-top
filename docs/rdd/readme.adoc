= 林技研株式会社 販売管理システム
:toc:
:sectnums:
:imagesdir: images
:data-uri:
:icons: font
:mermaid-them: forest
:mermaid-background: ffffff

<<<

== 概要
[.lead]
林技研株式会社製品の販売契約を結んだ代理店と、注文以降の事務処理を効率的に行うための機能を提供します。

=== 概念図
[plantuml, target=diagram-classes, format=png]   
....
@startuml "cropped"
!include C4_Context.puml

LAYOUT_TOP_DOWN()
'LAYOUT_AS_SKETCH()
LAYOUT_WITH_LEGEND()

Person(customer, "購入者", "商品購入者")
System(ecommerce, "ECサイト", "代理店が運用するECサイト")

Enterprise_Boundary(c0, "販売管理システム") {
    Person(maker, "メーカー", "商品製造管理")
    Person(agent, "代理店", "商品販売者")
    Person(admin, "システム管理者", "")

    System(cropped, "販売管理", "代理店との注文・請求を管理するシステム。")
}

Rel_D(admin, cropped, "運用管理")
Rel_U(customer, ecommerce, "注文、購入")
Rel_D(ecommerce, agent, "注文情報の通知")
Rel_U(agent, cropped, "注文の入力")
Rel_U(maker, cropped, "注文請/請求の入力")
Rel(cropped, agent, "注文請/請求の通知")
Rel_L(agent, maker, "入金")
Rel(cropped, maker, "注文の通知")
Rel(maker, customer, "商品の発送")

@enduml
....


=== 用語説明

メーカー:: 林技研株式会社。
代理店:: 林技研株式会社の販売代理店。
システム管理者:: 販売管理システムの運用者。
購入者:: 林技研株式会社製品を購入したユーザ。

<<<

== 要求機能 (ワークフロー)

発注、注文請け、発送、請求、領収のワークフローごとに定義します。

[mermaid,target=workflow]
....
%%{init:{'theme':'base','themeVariables':{'primaryColor':'#263238','primaryTextColor':'#eceff1','primaryBorderColor':'#607d8b','lineColor':'#263238','textColor':'#607d8b'}}}%%

sequenceDiagram

    participant U as 購入者
    participant A as 代理店
    participant M as メーカー
    U-->>A: （注文・購入）
    A->>M: 注文
    M->>A: 注文請け
    M-->>U: （発送）
    M->>A: 請求
    A->>M: 入金
    M->>A: 領収
....

=== 発注
image::order_create.png[]

代理店からメーカーへの発注を示します。購入者からの注文はECサイトなどで管理されるため、当該システムでの範囲外になります。

==== 入力項目
代理店:: 発注した代理店
発注日時:: 発注した日時
注文詳細:: 商品ごとの注文内容
商品名::: 商品名
単価::: 商品の単価
数量::: 商品の数量
注文総額::: 注文の総額

送付先情報:: 配送に必要となる購入者の送付先情報
郵便番号::: 商品送付先の郵便番号
住所::: 商品送付先の住所
氏名::: 商品送付先の氏名
電話番号::: 商品送付先の電話番号

==== 機能要件
* ECサイトでの発注情報を元に注文を作成できること。
** Amazon, 楽天など代表的なECサイトから受信したEメールのコピー＆ペーストをサポートします。
* 新規作成および更新で、必須項目未入力の状態で一時保存ができること。
** 全項目未入力では一時保存不可。
* 必須項目入力で確定して発注できること。
* 発注後、注文番号が自動的に生成されます。
* 発注後、メーカーに注文情報がEメールで通知されること。

==== 権限制御
代理店:: 自店の注文を参照・更新できること。他店の注文を参照・更新できないこと。
メーカー:: すべての注文を参照できること。
システム管理者:: すべての注文を参照・更新できること。

=== 注文請け
メーカーが発注を了承した旨を発注元である代理店に伝えます。

==== 入力項目
注文請け日時:: 注文請けした日時

==== 機能要件
* 注文請け日時を任意の日時で登録できること。
** 未入力の場合、現在時刻で入力されること。
* 注文請け情報が代理店にEメールで通知されること。

==== 権限制御
代理店:: すべての注文請けを操作できないこと。
メーカー:: すべての注文を注文請けできること。
システム管理者:: すべての注文を注文請けできること。

=== 発送
メーカーが購入者に商品を発送した旨を代理店に伝えます。代理店は伝えられた情報をECサイトなどに登録します。

==== 入力項目
発送受付日時:: 配送業者から通知された受付日時
追跡番号:: 配送業者から通知された追跡番号

==== 機能要件
* 代理店に発送情報がEメールで通知されること。

=== 請求
image::invoice_create.png[]

メーカーから代理店へ請求書を送付します。

==== 入力項目
請求件名:: 請求書の件名
サイト:: 請求先のサイト
請求一覧:: 発注ごとの請求の一覧
請求金額:: 請求の総額
請求日時:: 請求する日時

==== 機能要件
* 指定期間での発注を元に請求を自動で作成できること。
** 月締めでの運用を想定します。
* 新規作成および更新で、必須項目未入力の状態で一時保存ができること。
** 全項目未入力では一時保存不可。
* 請求日時を任意の日時で登録できること。
** 未入力の場合、現在時刻で入力されること。
* 必須項目入力で請求確定できること。
* 請求確定後、請求番号が自動的に生成されます。
* 請求確定後、代理店に請求情報がEメールで通知されること。
** 請求書が添付されること。 

==== 権限制御
代理店:: 自店の請求を参照できること。他店の請求を参照・更新できないこと。
メーカー:: すべての請求を参照・更新できること。
システム管理者:: すべての請求を参照・更新できること。

=== 領収
メーカーが入金を確認した旨を代理店に伝えます。

==== 入力項目
領収日時::: 領収した日時

==== 機能要件
* 確定後、代理店に領収情報がEメールで通知されること。
** 領収書を発行・送付しないこと。

==== 権限制御
代理店:: 自店の領収を参照できること。他店の領収を参照・更新できないこと。
メーカー:: すべての領収を参照・更新できること。
システム管理者:: すべての領収を参照・更新できること。

=== ダッシュボード
メーカー、代理店それぞれが次に実施すべき動作が把握できるように表示します。

==== 機能要件
===== メーカー
* 未発送の注文請け済みの注文一覧を表示します。
* 請求から２週間経過した未入金の請求一覧を表示します。

===== 代理店
* 未発注の注文一覧を表示します。
* 未入金の請求一覧を表示します。

<<<

== 要求機能 (マスタメンテナンス)

=== 代理店管理
image::agent_create.png[]

代理店の情報を管理します。

==== 項目
代理店名:: 代理店の名称
担当者:: 代理店の担当者
Email:: 代理店のEmail
電話番号:: 代理店の電話番号
郵便番号:: 代理店の郵便番号
住所:: 代理店の住所
ユーザアカウント:: 当該システムでのアカウント
サイト:: ECサイトの一覧
サイト名::: サイトの名称
URL::: サイトのインターネットURL

==== 権限制御
代理店:: 自店の情報のみ参照できること。
メーカー:: すべての情報を参照できること。
システム管理者:: すべての情報を参照・更新できること。

=== アカウント管理
当該システムのアカウント情報を管理します。ログイン時入力に利用します。

==== 項目
ユーザ名:: アカウント名
Email:: 本人確認用Email

==== 権限制御
代理店:: 自店のパスワード以外の情報を参照できること。
メーカー:: パスワード以外のすべての情報を参照できること。
システム管理者:: すべての情報を参照・更新できること。

<<<

== 要求機能 (共通機能)
image::login.png[]

=== 認証

* Email/password 入力で認証できること。
* スマートフォンで生成されたコードを利用して多要素認証できること。(TOPT方式)

==== 権限制御
すべての権限で同様にログインできること。
